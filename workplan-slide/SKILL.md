---
name: workplan-slide
description: ワークプラン・スケジュールスライドをPowerPointで作成。WBSからガントチャート形式のスライドを生成。python-pptxで矢羽根（PENTAGON）を使ったスケジュール表示。キーワード: ワークプラン, スケジュール, ガントチャート, 矢羽根, タイムライン, 工程表スライド
allowed-tools: Read, Write, Edit, Bash, Glob
---

# Workplan Slide Skill

WBSをベースに、ガントチャート形式のスケジュールスライドを作成するためのガイドライン。
python-pptx を使用し、矢羽根（PENTAGON）で視覚的なタイムラインを表現する。

---

## 失敗から学んだ教訓【重要】

### ❌ やってはいけないこと

| 失敗パターン | 問題点 | 正しいアプローチ |
|-------------|--------|-----------------|
| **WBSを詳細にそのまま転記** | タスク数が多すぎてスライドが見づらい | フェーズ単位で統合（5-6行が限界） |
| **短い矢羽根を大量生成** | 文字が入らない、見づらい | 短いタスクは統合して1本にまとめる |
| **週数を12週で固定** | 実際のスケジュールと合わない | WBSの期間を確認してから週数を決める |
| **行を詰め込みすぎ** | フォントが小さくなり読めない | 6行×3本程度が最大（row_height: 0.8以上） |
| **マイルストーンがない** | 重要ポイントが分からない | キックオフ、中間、最終報告を明示 |
| **開発とテストを別行** | 行が多くなりすぎる | 「開発・改善」として1行にまとめる |

### ✅ 必ずやること

1. **WBSを読んでから作る**
   - スライド作成前に必ずWBS Excelを読み込む
   - 期間、フェーズ数、担当者を確認

2. **フェーズを5-6行に統合**
   - 業務要件定義、評価設計、開発①、開発②、成果物作成 など
   - 「開発+テスト」は1行にまとめる

3. **矢羽根は1行に2-3本まで**
   - 短いタスクは統合
   - 文字が読める最小幅を確保（1.5週以上推奨）

4. **マイルストーンを追加**
   - キックオフ、中間チェックポイント、最終報告
   - ▼マークで視覚的に強調

5. **色分けルールを統一**
   - 顧客: 薄オレンジ（#FFDAC8）
   - 自社: 薄ブルー（#C8DCFF）
   - 協力会社: グレー（#E0E0E0）

---

## 最終版との差分（今回の学び）

### ユーザー修正点

| 項目 | 私の出力 | ユーザー修正 |
|------|---------|-------------|
| **分類名** | 開発・改善① | 開発① |
| **マイルストーン** | 2つのみ | 4つ追加（開発開始、開発①完了、開発②完了） |
| **矢羽根テキスト** | 改行なし | 必要に応じて改行（例: データ提供・↵フロー説明） |
| **最終報告の矢羽根** | あり | 削除（マイルストーンのみ） |

### 教訓

- **シンプルなラベル**: 「開発・改善①」より「開発①」の方がスライド向き
- **マイルストーンを増やす**: 主要な節目を追加して進捗感を出す
- **矢羽根テキストの改行**: 幅が狭い場合は改行で対応
- **重複表現を避ける**: マイルストーンで示す内容は矢羽根不要

---

## 標準レイアウト

### スライド構成

```
[タイトル: ワークプラン]
[凡例: 東邦ガス様 / NTTD / FLUX]

[ヘッダー: 月ラベル + 週番号]
[マイルストーン行: ▼キックオフ ▼開発開始 ▼完了...]
[フェーズ1行: 矢羽根2-3本]
[フェーズ2行: 矢羽根2-3本]
...
[フェーズN行: 矢羽根2-3本]

[備考: ※ 事前準備は1/6以前から着手]
```

### 推奨サイズ

| 項目 | 値 |
|------|-----|
| 行数 | 5-6行（マイルストーン含む） |
| 週幅 | 0.7-0.8インチ |
| 行高さ | 0.8インチ以上 |
| フォント | 9-10pt |
| 矢羽根高さ | 0.25-0.3インチ |
| 矢羽根間隔 | 0.03-0.05インチ |

---

## コードパターン

### 色定義

```python
from pptx.dml.color import RGBColor

CUSTOMER_COLOR = RGBColor(255, 218, 200)   # 東邦ガス様（薄オレンジ）
FLUX_COLOR = RGBColor(200, 220, 255)       # FLUX（薄ブルー）
NTTD_COLOR = RGBColor(224, 224, 224)       # NTTD（グレー）
```

### 矢羽根（PENTAGON）

```python
from pptx.enum.shapes import MSO_SHAPE
from pptx.util import Inches, Pt

shape = slide.shapes.add_shape(
    MSO_SHAPE.PENTAGON,
    Inches(bar_left), Inches(bar_top),
    Inches(bar_width), Inches(bar_height)
)
shape.fill.solid()
shape.fill.fore_color.rgb = FLUX_COLOR
shape.line.color.rgb = RGBColor(180, 180, 180)
shape.line.width = Pt(0.5)
```

### マイルストーン表示

```python
ms_text = slide.shapes.add_textbox(
    Inches(ms_left), Inches(ms_top),
    Inches(0.8), Inches(0.56)
)
tf = ms_text.text_frame
p = tf.paragraphs[0]
p.text = "▼1/6\nキックオフ"
p.font.size = Pt(9)
p.font.bold = True
p.alignment = PP_ALIGN.CENTER
```

### 統合矢羽根データの定義

```python
# 行idx, スロット, 開始週, 終了週, ラベル, 色
bars = [
    # 業務要件定義（W1-W3）→ 2本に統合
    (1, 0, 0, 1.5, "データ提供・\nフロー説明", CUSTOMER_COLOR),
    (1, 1, 0.5, 3.0, "要件ヒアリング・設計", FLUX_COLOR),

    # 開発①（W3-W8）→ 3本に統合
    (3, 0, 2.0, 5.0, "エージェント開発①", FLUX_COLOR),
    (3, 1, 5.0, 7.0, "評価・フィードバック①", CUSTOMER_COLOR),
    (3, 2, 6.5, 8.0, "改善分析・\n方針決定", FLUX_COLOR),
]
```

---

## WBSからスライドへの変換ルール

### フェーズ統合

| WBSのフェーズ | スライドの行 |
|--------------|-------------|
| 事前準備 | 備考欄に記載 |
| 業務要件定義 | 業務要件定義 |
| 評価設計 | 評価設計 |
| エージェント開発① + テスト・改善① | 開発① |
| エージェント開発② + テスト・改善② | 開発② |
| 成果物作成 | 成果物作成 |

### 担当別の表現

| 担当 | スライド表現 |
|------|-------------|
| 顧客タスク | 顧客色の矢羽根 |
| 自社タスク | 自社色の矢羽根 |
| 両社タスク | 顧客色 or 主担当色 |
| マイルストーン | ▼マーク（色なし） |

---

## チェックリスト

### 作成前
- [ ] WBSを読み込んでスケジュール期間を確認
- [ ] フェーズ数を5-6行に絞り込み
- [ ] マイルストーンを決定

### 作成時
- [ ] 行高さ0.8インチ以上
- [ ] 矢羽根1行に2-3本まで
- [ ] 文字が読める（9pt以上）
- [ ] 色分けが統一されている

### 納品前
- [ ] マイルストーンが見やすい
- [ ] 凡例と矢羽根の色が一致
- [ ] 備考欄に事前準備の説明あり
- [ ] バージョン付きファイル名で保存

---

## よくある質問

### Q: 矢羽根が重なってしまう場合は？
A: スロット番号を分けて縦にずらすか、タスクを統合して1本にまとめる。

### Q: 週の境界をまたぐタスクの表現は？
A: 開始週・終了週を小数点で指定（例: W2の途中から = 1.5）

### Q: WBSにないマイルストーンを追加していいか？
A: 可。「開発開始」「評価開始」など、視覚的な節目として追加推奨。

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2024-12-24 | v1.0.0: 初版。東邦ガスワークプラン作成の教訓を反映 |
